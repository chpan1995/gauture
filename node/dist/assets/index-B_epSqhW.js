import{g as O}from"./index-BglKwrYI.js";import{t as y}from"./index-B-EWubiB.js";import{d as L,r as d,x as P,c as n,b as l,e as o,w as r,f as i,F as f,m as g,n as A,i as q,k as x,t as V,C as b,o as s}from"./index-C7oGZG6Y.js";import"./request-Bboo2TiE.js";const G={class:"main"},H={style:{display:"flex","align-items":"center",gap:"10px","margin-bottom":"24px"}},K={class:"first_type_div"},Q={class:"first_value_span"},W={class:"first_tags"},X={class:"first_tags_value"},Y={key:0,class:"divider"},Z={class:"dia",style:{height:"630px",overflow:"auto"}},ee={style:{display:"flex","justify-content":"flex-end","margin-top":"10px","margin-bottom":"30px"}},te={key:0,class:"first_type_div"},ae={class:"first_value_span"},le={key:1,class:"first_tags"},se={class:"first_tags_value"},ne={key:2,class:"divider"},oe={style:{display:"flex","justify-content":"flex-end","margin-top":"10px"}},fe=L({__name:"index",setup(re){const u=d(),w=d(!1),m=d(""),v=d(),I=d(),_=d(),h=d([]);P(async()=>{let a=await O.reqTypeInfo();if(a.code===200){a.data.forEach(p=>{h.value.push({value:p.id,label:p.name})}),h.value.length>0&&(u.value=h.value[0].value);let e=await y.reqTagsInfo({typeid:u.value,deep:1});_.value=e.data}});const F=a=>{const e=a.target.files[0];if(!e)return;const p=new FileReader;p.onload=C=>{m.value=C.target.result},p.readAsText(e)},N=()=>{try{let a=JSON.parse(m.value);Array.isArray(a)?v.value=a:b.alert("内容输入有误",{confirmButtonText:"确定"})}catch{b.alert("内容输入有误",{confirmButtonText:"确定"})}},j=async()=>{let a=await y.reqTagsInfo({typeid:u.value,deep:1});_.value=a.data},R=async()=>{let a=await y.reqAddTags({chrildobj:JSON.stringify(v.value),deep:1,typeid:u.value});if(a.code!==200){b.alert("保存标签出错",{confirmButtonText:"确定"});return}a=await y.reqTagsInfo({typeid:u.value,deep:1}),_.value=a.data,w.value=!1},U=async a=>{let e=await y.reqDeleteTags({id:a});if(e.code!==200){b.alert("删除标签出错",{confirmButtonText:"确定"});return}e=await y.reqTagsInfo({typeid:u.value,deep:1}),_.value=e.data},z=()=>{v.value=[],m.value="",I.value.value=""};return(a,e)=>{const p=i("el-option"),C=i("el-select"),k=i("el-button"),D=i("Remove"),E=i("el-icon"),J=i("el-popconfirm"),S=i("el-card"),$=i("el-input"),M=i("el-dialog");return s(),n("div",G,[l("div",H,[e[5]||(e[5]=l("p",null,"种类：",-1)),o(C,{modelValue:u.value,"onUpdate:modelValue":e[0]||(e[0]=t=>u.value=t),onChange:j,size:"large",style:{width:"240px"}},{default:r(()=>[(s(!0),n(f,null,g(h.value,t=>(s(),A(p,{key:t.value,label:t.label,value:t.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"]),o(k,{type:"primary",onClick:e[1]||(e[1]=t=>w.value=!0)},{default:r(()=>e[4]||(e[4]=[q(" 新增配置 ")])),_:1})]),o(S,null,{default:r(()=>[(s(!0),n(f,null,g(_.value,(t,c)=>(s(),n(f,{key:c},[l("div",K,[e[6]||(e[6]=l("span",{class:"first_type_span"}," 一级分类 ",-1)),l("span",Q,V(t.value),1),o(J,{title:`你确定要删除${t.value}分类?`,width:"260px",onConfirm:T=>U(t.id)},{reference:r(()=>[o(k,{style:{width:"24px",height:"24px",border:"none","margin-left":"-6px"},circle:""},{default:r(()=>[o(E,{size:24,color:"#FF0000"},{default:r(()=>[o(D)]),_:1})]),_:1})]),_:2},1032,["title","onConfirm"])]),l("div",W,[(s(!0),n(f,null,g(t.items,(T,B)=>(s(),n("div",{key:B,style:{display:"flex","align-items":"center",gap:"10px","flex-wrap":"wrap"}},[e[7]||(e[7]=l("span",{class:"first_tags_span"}," 一级标签 ",-1)),l("span",X,V(T.value),1)]))),128))]),c!==_.value.length-1?(s(),n("hr",Y)):x("",!0)],64))),128))]),_:1}),o(M,{modelValue:w.value,"onUpdate:modelValue":e[3]||(e[3]=t=>w.value=t),title:"新增配置",width:"900",style:{height:"700px"},onClose:z},{default:r(()=>[l("div",Z,[l("input",{type:"file",ref_key:"fileInputRef",ref:I,onChange:F,accept:".json"},null,544),o($,{modelValue:m.value,"onUpdate:modelValue":e[2]||(e[2]=t=>m.value=t),style:{width:"100%","margin-top":"10px","margin-bottom":"10px"},rows:2,type:"textarea",placeholder:"Please input",resize:"none"},null,8,["modelValue"]),l("div",ee,[o(k,{type:"primary",onClick:N},{default:r(()=>e[8]||(e[8]=[q("解析")])),_:1})]),(s(!0),n(f,null,g(v.value,(t,c)=>(s(),n(f,{key:c},[t.value?(s(),n("div",te,[e[9]||(e[9]=l("span",{class:"first_type_span"}," 一级分类 ",-1)),l("span",ae,V(t.value),1)])):x("",!0),t.items?(s(),n("div",le,[(s(!0),n(f,null,g(t.items,(T,B)=>(s(),n("div",{key:B,style:{display:"flex","align-items":"center",gap:"10px","flex-wrap":"wrap"}},[e[10]||(e[10]=l("span",{class:"first_tags_span"}," 一级标签 ",-1)),l("span",se,V(T.value),1)]))),128))])):x("",!0),c!==v.value.length-1&&t.value?(s(),n("hr",ne)):x("",!0),l("div",oe,[c===v.value.length-1&&t.value?(s(),A(k,{key:0,type:"primary",onClick:R},{default:r(()=>e[11]||(e[11]=[q(" 保存 ")])),_:1})):x("",!0)])],64))),128))])]),_:1},8,["modelValue"])])}}});export{fe as default};
